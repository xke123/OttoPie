# OttoPie - è‡ªåŠ¨åŒ– Python ä»»åŠ¡ç®¡ç†å¹³å° ğŸ™ğŸ¥§

![OttoPie Logo](image.webp)

**OttoPie** æ˜¯ä¸€æ¬¾è·¨å¹³å°çš„ Python è‡ªåŠ¨åŒ–ä»»åŠ¡ç®¡ç†å·¥å…·ã€‚å®ƒçš„åå­—æ¥æºäº "Otto"ï¼ˆå…«çˆªé±¼ ğŸ™ï¼Œè°éŸ³ Autoï¼Œä»£è¡¨å¤šä»»åŠ¡ä¸è‡ªåŠ¨åŒ–ï¼‰å’Œ "Pie"ï¼ˆè°éŸ³æ´¾ï¼Œä»£è¡¨ Python ç”Ÿæ€ï¼‰ã€‚OttoPie è®©ä½ åƒå…«çˆªé±¼ä¸€æ ·çµæ´»ç®¡ç†å¤šä¸ª Python è‡ªåŠ¨åŒ–ä»»åŠ¡ï¼Œå¹¶æä¾›å›¾å½¢åŒ–ç•Œé¢ã€å®šæ—¶è°ƒåº¦ã€è„šæœ¬ç®¡ç†ã€æ—¥å¿—è®°å½•ä»¥åŠæ’ä»¶åŒ–æ‰©å±•åŠŸèƒ½ã€‚

---

## âœ¨ åŠŸèƒ½ç‰¹ç‚¹

- **ğŸ“‹ è„šæœ¬ç®¡ç†**ï¼šæ”¯æŒåŠ è½½ã€åˆ é™¤ã€é…ç½® Python è„šæœ¬ï¼Œè®©ä»»åŠ¡ç®¡ç†æ›´ç›´è§‚ã€‚
- **â³ ä»»åŠ¡è°ƒåº¦**ï¼šæ”¯æŒå®šæ—¶æ‰§è¡Œ Python è„šæœ¬ï¼Œè‡ªåŠ¨åŒ–å¤„ç†æ—¥å¸¸ä»»åŠ¡ã€‚
- **ğŸ“‚ æ–‡ä»¶ç›‘æ§**ï¼šå¯ç»“åˆæ’ä»¶è„šæœ¬ï¼Œå®ç°å¯¹æ–‡ä»¶å¤¹å˜åŒ–çš„å®æ—¶ç›‘æ§ã€‚
- **ğŸ–¥ï¸ å›¾å½¢ç•Œé¢**ï¼šåŸºäº PyQt æ„å»ºï¼Œæ— éœ€å‘½ä»¤è¡Œå³å¯æ“ä½œã€‚
- **ğŸ’¾ ä»»åŠ¡æ—¥å¿—**ï¼šé›†ä¸­è®°å½•è„šæœ¬è¿è¡Œæ—¥å¿—ï¼Œæ–¹ä¾¿æŸ¥çœ‹æ‰§è¡ŒçŠ¶æ€ã€‚
- **ğŸ”Œ æ’ä»¶å¼æ¶æ„**ï¼šæ”¯æŒè‡ªå®šä¹‰æ’ä»¶æ‰©å±•åŠŸèƒ½ï¼Œåªéœ€å®ç°ç®€å•æ¥å£ï¼Œå³å¯è½»æ¾æ‰©å±•ã€‚
- **ğŸ“¦ æ’ä»¶æ‰“åŒ…**ï¼šæ’ä»¶å¼€å‘è€…å¯å°†æ’ä»¶æ‰“åŒ…æˆè‡ªåŒ…å«åŒ…ï¼Œæ‰©å±•åä¸º **.ottopie**ï¼Œæ’ä»¶åŒ…å†…åŒ…å«æ’ä»¶ä»£ç ã€å…ƒæ•°æ®å’Œæ‰€æœ‰ä¾èµ–ï¼Œä¿è¯ç¦»çº¿ç¯å¢ƒä¸‹ä¹Ÿèƒ½æ­£å¸¸ä½¿ç”¨ã€‚

---

## ğŸš€ å®‰è£…ä¸è¿è¡Œ

### å®‰è£…ä¾èµ–

OttoPie åŸºäº Python 3 è¿è¡Œï¼Œè¯·ç¡®ä¿å·²å®‰è£… Python 3.xã€‚

### è¿è¡Œ OttoPie

è¯¥é¡¹ç›®å·²åŒ…å«è™šæ‹Ÿç¯å¢ƒæ–‡ä»¶ venv.zipï¼Œéœ€è¦è§£å‹åä½¿ç”¨ã€‚ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œå·²ç»æ·»åŠ äº†å„å¹³å°ä¸€é”®å¯åŠ¨è„šæœ¬ï¼Œå­˜æ”¾äº run_scripts/ ç›®å½•ä¸­ã€‚
æ ¹æ®æ‰€åœ¨å¹³å°ï¼Œä½¿ç”¨ç›¸åº”è„šæœ¬å¯åŠ¨ä¸»ç¨‹åºï¼š
Windowsï¼šåŒå‡» run_scripts/windows_main.bat
macOSï¼šåŒå‡» run_scripts/macos_main.command
Linuxï¼šåœ¨ç»ˆç»“ä¸­è¿è¡Œ ./run_scripts/linux_main.sh

å¦‚éœ€è¦è¿è¡Œæ’ä»¶æ‰“åŒ…ç¨‹åºï¼š
Windowsï¼šåŒå‡» run_scripts/windows_packager.bat
macOSï¼šåŒå‡» run_scripts/macos_packager.command
Linuxï¼šåœ¨ç»ˆç»“ä¸­è¿è¡Œ ./run_scripts/linux_packager.sh

è¿è¡Œè„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥å¹¶è§£å‹ venv.zipï¼Œä½¿ç”¨è™šæ‹Ÿç¯å¢ƒè¿è¡Œ OttoPieã€‚
---

## ğŸ—ï¸ ä½¿ç”¨æŒ‡å—

### 1ï¸âƒ£ æ·»åŠ ä»»åŠ¡

1. æ‰“å¼€ OttoPieï¼Œè¿›å…¥â€œè„šæœ¬ç®¡ç†â€é¡µé¢ã€‚
2. ç‚¹å‡» **â€œæ·»åŠ ä»»åŠ¡â€** æŒ‰é’®ï¼Œå¼¹å‡ºè„šæœ¬é…ç½®çª—å£ï¼š
   - **é€‰æ‹©è„šæœ¬æ–‡ä»¶**ï¼šä½ å¯ä»¥é€‰æ‹©ä¼ ç»Ÿçš„ Python è„šæœ¬ï¼ˆ`.py` æ–‡ä»¶ï¼‰æˆ–æ‰“åŒ…ä¸º **.ottopie** æ ¼å¼çš„æ’ä»¶åŒ…ã€‚
   - é€‰æ‹© **æºæ–‡ä»¶å¤¹** å’Œ **ç›®æ ‡æ–‡ä»¶å¤¹**ï¼ˆå¦‚æœä»»åŠ¡éœ€è¦ï¼‰ã€‚
   - è®¾ç½® **æ‰§è¡Œé—´éš”**ï¼Œæ”¯æŒå¤©ã€å°æ—¶ã€åˆ†é’Ÿå’Œç§’çš„çµæ´»è®¾ç½®ã€‚
3. ç‚¹å‡» **ç¡®å®š** åï¼Œä»»åŠ¡ä¼šæ·»åŠ åˆ°ä»»åŠ¡åˆ—è¡¨ä¸­ã€‚

### 2ï¸âƒ£ å¯åŠ¨ / åœæ­¢ä»»åŠ¡

- åœ¨â€œè„šæœ¬ç®¡ç†â€é¡µé¢ï¼Œç‚¹å‡» **â€œå¯åŠ¨â€** æŒ‰é’®ï¼Œä»»åŠ¡å°†æŒ‰ç…§è®¾å®šçš„é—´éš”æ‰§è¡Œã€‚
- ç‚¹å‡» **â€œåœæ­¢â€** æŒ‰é’®ï¼Œå¯æš‚åœä»»åŠ¡æ‰§è¡Œã€‚

### 3ï¸âƒ£ ç¼–è¾‘ä»»åŠ¡é…ç½®

- ç‚¹å‡» **â€œç¼–è¾‘é…ç½®â€** æŒ‰é’®ï¼Œå¯é‡æ–°é…ç½®ä»»åŠ¡å‚æ•°ï¼ˆå¦‚è„šæœ¬æ–‡ä»¶ã€æ‰§è¡Œé—´éš”ã€æº/ç›®æ ‡æ–‡ä»¶å¤¹ç­‰ï¼‰ã€‚
- ç¼–è¾‘æ—¶ä»»åŠ¡ä¼šè‡ªåŠ¨åœæ­¢ï¼Œä¿®æ”¹å®Œæˆåå¯é‡æ–°å¯åŠ¨ä»»åŠ¡ã€‚

### 4ï¸âƒ£ åˆ é™¤ä»»åŠ¡

- ç‚¹å‡» **â€œåˆ é™¤â€** æŒ‰é’®ï¼Œå¯å°†ä»»åŠ¡ä»åˆ—è¡¨ä¸­ç§»é™¤ï¼ˆä¸ä¼šåˆ é™¤å®é™…è„šæœ¬æ–‡ä»¶ï¼‰ã€‚

### 5ï¸âƒ£ æŸ¥çœ‹æ—¥å¿—

- åˆ‡æ¢åˆ° **â€œä»»åŠ¡æ—¥å¿—â€** é€‰é¡¹å¡ï¼ŒæŸ¥çœ‹ä»»åŠ¡çš„è¿è¡ŒçŠ¶æ€å’Œå†å²è®°å½•ã€‚

---

## ğŸ”Œ æ’ä»¶å¼€å‘ä¸æ‰“åŒ…

OttoPie é‡‡ç”¨æ’ä»¶åŒ–æ¶æ„ï¼Œå…è®¸ä½ æ‰©å±•æ›´å¤šåŠŸèƒ½ã€‚æ’ä»¶å¿…é¡»ä»¥ **.py** è„šæœ¬æˆ–æ‰“åŒ…ä¸º **.ottopie** æ–‡ä»¶çš„å½¢å¼åŠ è½½ã€‚

### 1. æ’ä»¶æ¥å£è§„èŒƒ

æ¯ä¸ªæ’ä»¶ï¼ˆæ— è®ºæ˜¯å•ä¸ª .py è„šæœ¬è¿˜æ˜¯æ‰“åŒ…åçš„ .ottopie æ’ä»¶åŒ…ï¼‰éƒ½å¿…é¡»å®ç°å¦‚ä¸‹æ¥å£ï¼š

#### å¿…é¡»å®ç° `run(params)` å‡½æ•°

- **å‚æ•°**ï¼š  
  - `params` æ˜¯ä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«ä»»åŠ¡è¿è¡Œæ—¶ä¼ å…¥çš„é…ç½®ä¿¡æ¯ã€‚  
    ä¾‹å¦‚ï¼Œå¯¹äºæ–‡ä»¶åŒæ­¥ä»»åŠ¡ï¼Œ`params` å¯èƒ½åŒ…å«ï¼š
    - `"src"`ï¼šæºæ–‡ä»¶å¤¹è·¯å¾„
    - `"tgt"`ï¼šç›®æ ‡æ–‡ä»¶å¤¹è·¯å¾„

- **è¿”å›å€¼**ï¼š  
  - `run(params)` å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºè®°å½•ä»»åŠ¡æ‰§è¡Œç»“æœï¼ˆå¦‚æˆåŠŸä¿¡æ¯æˆ–é”™è¯¯æè¿°ï¼‰ã€‚

#### ç¤ºä¾‹è¯´æ˜

ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†ä¸€ä¸ªæ’ä»¶å¦‚ä½•å®ç° `run(params)` æ¥å£ã€‚æ’ä»¶åŠŸèƒ½ä¸ºé€’å½’åŒæ­¥æºæ–‡ä»¶å¤¹ä¸ç›®æ ‡æ–‡ä»¶å¤¹ï¼Œå¹¶ç»Ÿè®¡æ‹·è´ã€æ›´æ–°ã€åˆ é™¤å’Œè·³è¿‡çš„æ–‡ä»¶æ•°ï¼š

```python
import os
import shutil

def sync_folders(src, tgt, counters):
    """
    é€’å½’åŒæ­¥ src ä¸ tgt æ–‡ä»¶å¤¹ï¼Œä½¿ tgt æˆä¸º src çš„å®Œæ•´é•œåƒã€‚

    å‚æ•°ï¼š
      - src: æºæ–‡ä»¶å¤¹è·¯å¾„
      - tgt: ç›®æ ‡æ–‡ä»¶å¤¹è·¯å¾„
      - counters: ç»Ÿè®¡æ“ä½œæ¬¡æ•°çš„å­—å…¸ï¼ŒåŒ…æ‹¬ 'copied', 'updated', 'deleted', 'skipped'
    """
    if not os.path.exists(tgt):
        os.makedirs(tgt)
    
    for entry in os.listdir(src):
        src_entry = os.path.join(src, entry)
        tgt_entry = os.path.join(tgt, entry)
        if os.path.isdir(src_entry):
            sync_folders(src_entry, tgt_entry, counters)
        else:
            if not os.path.exists(tgt_entry):
                shutil.copy2(src_entry, tgt_entry)
                counters["copied"] += 1
            else:
                if os.path.getmtime(src_entry) > os.path.getmtime(tgt_entry):
                    shutil.copy2(src_entry, tgt_entry)
                    counters["updated"] += 1
                else:
                    counters["skipped"] += 1

    for entry in os.listdir(tgt):
        tgt_entry = os.path.join(tgt, entry)
        src_entry = os.path.join(src, entry)
        if not os.path.exists(src_entry):
            if os.path.isdir(tgt_entry):
                shutil.rmtree(tgt_entry)
            else:
                os.remove(tgt_entry)
            counters["deleted"] += 1

def run(params):
    """
    åŒæ­¥ä»»åŠ¡æ¥å£ï¼Œå¿…é¡»å®ç° run(params) æ¥å£ã€‚

    å‚æ•°ï¼š
      - params: å­—å…¸ï¼Œå¿…é¡»åŒ…å« "src"ï¼ˆæºæ–‡ä»¶å¤¹è·¯å¾„ï¼‰å’Œ "tgt"ï¼ˆç›®æ ‡æ–‡ä»¶å¤¹è·¯å¾„ï¼‰

    è¿”å›ï¼š
      - å­—ç¬¦ä¸²ï¼Œæè¿°æ“ä½œç»“æœ
    """
    src = params.get("src", "").strip()
    tgt = params.get("tgt", "").strip()
    
    if not src or not tgt:
        return "é”™è¯¯ï¼šè¯·æŒ‡å®šæºæ–‡ä»¶å¤¹å’Œç›®æ ‡æ–‡ä»¶å¤¹ã€‚"
    if not os.path.isdir(src):
        return "é”™è¯¯ï¼šæºæ–‡ä»¶å¤¹ä¸å­˜åœ¨ã€‚"
    
    counters = {"copied": 0, "updated": 0, "deleted": 0, "skipped": 0}
    
    try:
        sync_folders(src, tgt, counters)
        return ("åŒæ­¥å®Œæˆï¼šå¤åˆ¶æ–‡ä»¶ {copied} ä¸ªï¼Œæ›´æ–°æ–‡ä»¶ {updated} ä¸ªï¼Œåˆ é™¤æ–‡ä»¶ {deleted} ä¸ªï¼Œè·³è¿‡ {skipped} ä¸ªæ–‡ä»¶ã€‚"
                .format(**counters))
    except Exception as e:
        return "åŒæ­¥è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: " + str(e)
```

### 2. æ’ä»¶æ‰“åŒ…å·¥å…·

ä¸ºäº†æ–¹ä¾¿æ’ä»¶å¼€å‘è€…æ‰“åŒ…æ’ä»¶ï¼ŒOttoPie æä¾›äº†ä¸€ä¸ªæ’ä»¶æ‰“åŒ…å·¥å…·ï¼Œè¯¥å·¥å…·å¯ä»¥è‡ªåŠ¨ï¼š
- è‡ªåŠ¨æ‰«ææ’ä»¶ä»£ç ç”Ÿæˆ `requirements.txt`ï¼ˆå¯¹äºä¾èµ–è¾ƒå¤šçš„æ’ä»¶ï¼‰ï¼›
- ä½¿ç”¨ `pip download` ä¸‹è½½ä¾èµ–åˆ° `vendor` ç›®å½•ä¸­ï¼ˆä¿è¯ç¦»çº¿æ—¶å¯ç”¨ï¼‰ï¼›
- æŒ‰ç…§æ ‡å‡†æ ¼å¼ç”Ÿæˆæ’ä»¶åŒ…ï¼Œè¾“å‡ºæ‰©å±•åä¸º **.ottopie**ã€‚

#### ä½¿ç”¨è¯´æ˜

1. **è¿è¡Œæ‰“åŒ…å·¥å…·**  
   åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œï¼š
   ```sh
   python ottopie_packager.py
   ```
   ï¼ˆè¯·ç¡®ä¿ç¯å¢ƒä¸­å·²å®‰è£… Pythonã€pip å’Œ pipreqsã€‚ï¼‰

2. **ä¾æ¬¡è¾“å…¥æç¤ºä¿¡æ¯**  
   - è¾“å…¥æ’ä»¶ä¸»è„šæœ¬æ–‡ä»¶è·¯å¾„ï¼ˆä¾‹å¦‚ `plugin.py`ï¼‰ã€‚
   - å¡«å†™æ’ä»¶åŸºæœ¬ä¿¡æ¯ï¼ˆåç§°ã€ç‰ˆæœ¬ã€æè¿°ã€å…¥å£æ¨¡å—æ–‡ä»¶åï¼‰ã€‚
   - å·¥å…·è‡ªåŠ¨åœ¨ä¸´æ—¶æ’ä»¶ç›®å½•ä¸­è¿è¡Œ pipreqs ç”Ÿæˆ `requirements.txt`ï¼Œç„¶åè‡ªåŠ¨ä¸‹è½½ä¾èµ–åˆ° `vendor` ç›®å½•ä¸­ã€‚
   - è¾“å…¥ç”Ÿæˆçš„æ’ä»¶åŒ…åç§°ï¼ˆä¸å«æ‰©å±•åï¼‰ï¼Œå·¥å…·ä¼šç”Ÿæˆæ‰©å±•åä¸º `.ottopie` çš„æ’ä»¶åŒ…ã€‚

3. **ç”Ÿæˆçš„æ’ä»¶åŒ…**  
   æ‰“åŒ…å·¥å…·ç”Ÿæˆçš„æ’ä»¶åŒ…å°†åŒ…å«ï¼š
   - æ’ä»¶ä¸»è„šæœ¬ï¼ˆå…¥å£æ¨¡å—ï¼‰
   - è‡ªåŠ¨ç”Ÿæˆçš„ `requirements.txt`ï¼ˆå¯é€‰ï¼Œä»…ä¾›å‚è€ƒï¼‰
   - `plugin.json`ï¼ˆæ’ä»¶å…ƒæ•°æ®ï¼‰
   - `vendor/` ç›®å½•ï¼ˆæ‰€æœ‰ä¾èµ–åŒ…ï¼‰

è¯¥æ’ä»¶åŒ…å¯ç›´æ¥åœ¨ OttoPie ä¸­åŠ è½½ä½¿ç”¨ã€‚

---

## ğŸ“œ è®¸å¯è¯

OttoPie éµå¾ª MIT è®¸å¯è¯ï¼Œä½ å¯ä»¥è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†å‘æœ¬è½¯ä»¶ã€‚

---

OttoPie â€”â€” è®©ä½ çš„ Python ä»»åŠ¡è‡ªåŠ¨åŒ–ç®¡ç†å˜å¾—æ›´ç®€å•ï¼ğŸ™ğŸ¥§

